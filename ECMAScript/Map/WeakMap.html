<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
        // WeakMap结构与Map类似，也是不重复的值的集合。但是，它与Map有两个区别:
        // 第一：WeakMap只接受[对象类型]（null除外）作为[键名]，不接受其他类型的值作为键名，否则报错    
        // 第二，WeakMap中[键所对应的对象]都是[弱引用]，即垃圾回收机制不考虑WeakMap对该对象的引用，不会产生内存泄漏
        // 注意，WeakMap弱引用的[只是键名，而不是键值]。键值里的对象数据依然是[正常引用]。
        // WeakMap一个典型应用场景是，在网页的DOM元素上添加数据，就可以使用WeakMap结构，当该 DOM 元素被清除，其所对应的WeakMap记录就会自动被移除
        // new WeakMap([[1, 3]]); // 报错
        // new WeakMap([[null, 1]]); // 报错
        // new WeakMap(); // 不报错
        // new WeakMap([]); // 不报错
        // new WeakMap([[{a:1}, 1]]); // 不报错
        const obj1 = { a: 1 };
        const wmap1 = new WeakMap([
            [obj1, '张三'], 
            [{ b: 2 }, '李四']
        ]);
        // console.log(wmap1);

        // 没有iterator接口，不可遍历
        // console.log(wmap1[Symbol.iterator]);// undefined 

        // 没有size，不可遍历
        // console.log(wmap1.size);// undefined 

        // 没有forEach
        // console.log(wmap1.forEach);// undefined 

        // 实例下有get()、set()、has()、delete()方法，用法与map的一致，参考map文件
        // console.log(wmap1.get(obj1));// 张三

        wmap1.set(obj1, '张三改');
        // console.log(wmap1.get(obj1));// 张三改

        // console.log(wmap1.has(obj1));// true

        wmap1.delete(obj1);
        // console.log(wmap1.has(obj1));// false


    </script>
</body>
</html>