<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>drawImage</title>
</head>
<style>
    * {
        margin: 0;
        padding: 0;
    }

    .clearfix {
        height: 800px;
    }

    .cavs {
        border: 1px solid #ccc;
        float: left;
    }
</style>

<body class="clearfix">
    <div style="padding-left: 85px;height: 30px;line-height: 30px;">X→</div>
    <div style="width: 40px;float: left;height: 100%;text-align: center;width: 30px;margin-left: 50px">
        <p>Y</p>
        <p>↓</p>
    </div>
    <canvas id="cavs" class="cavs" width="1400" height="800"></canvas>
    <script>
        const oCavs = document.querySelector("#cavs");
        const ctx = oCavs.getContext('2d');
        ctx.fillRect(0,0,1400,800);
        // 图片
        const img = new Image();
        img.src = "https://bpic.588ku.com/element_pic/00/16/08/1157ac888389bc5.jpg!/fw/254/quality/90/unsharp/true/compress/true";
        // 受限于 CORS 策略，会存在跨域问题，虽然可以使用图像（比如append到页面上）但是绘制到画布上会污染画布，一旦一个画布被污染,就无法提取画布的数据，
        // 比如无法使用使用画布toBlob(),toDataURL(),或getImageData()方法;当使用这些方法的时候 会抛出一个安全错误
        img.setAttribute("crossOrigin",'Anonymous');

        // [drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh)]
        // img 	规定要使用的图像、画布或视频。(必填)
        // sx 	开始剪切的x坐标位置。(选填)（图片左上角为0,0）
        // sy 	开始剪切的y坐标位置。(选填)
        // sw 	被剪切图像的宽度。(选填)
        // sh 	被剪切图像的高度。(选填)
        // dx 	在画布上放置图像的 x 坐标位置。(必填)
        // dy 	在画布上放置图像的 y 坐标位置。(必填)
        // dw 	要使用的图像的宽度。（伸展或缩小图像）(选填)
        // dh 	要使用的图像的高度。（伸展或缩小图像）(选填)

        // 3种用法：
        // 1.基础用法：
        // drawImage(image, dx, dy) 
        // 2.进行缩放：
        // drawImage(image, dx, dy, dw, dh) 
        // 从原图中剪切出一个矩形区域，然后把它画到画布上目标区域里
        // drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh)
        
        img.onload = function () { // 待img加载完成之后才能绘制
            ctx.drawImage(img, 0, 0);
            // ctx.drawImage(img, 100, 0, 100, 200);
            // ctx.drawImage(img, 0, 0, 30, 30, 300, 0, 100, 200);
            console.log(oCavs.toDataURL("image/png", 1.0));
        }

        // 视频
        // const video = document.createElement('video');
        // video.src = "../../asset/kangfuPanda.mp4";
        // video.controls = "controls";
        // video.autoplay = "true";
        // document.body.appendChild(video);
        
        // 监听play事件，绘制视频
        // let timer = null;
        // video.addEventListener('play', function () {
        //     timer = setInterval(function () {
        //             ctx.drawImage(video, 0, 300, 270, 135)
        //         },
        //         10); // 每10毫秒绘制一帧
        // }, false);
    </script>
</body>

</html>